IMAGEIO FFMPEG_WRITER WARNING: input image is not divisible by macro_block_size=16, resizing from (140, 140) to (144, 144) to ensure video compatibility with most codecs and players. To prevent resizing, make your input image divisible by the macro_block_size or set the macro_block_size to 1 (risking incompatibility).

Model not found -starting training...

Epoch: 0
Epoch 0/50 | Loss = 0.0395
------------------------------------------------------------
Epoch: 1
Epoch 1/50 | Loss = 0.0305
------------------------------------------------------------
Epoch: 2
Epoch 2/50 | Loss = 0.0032
------------------------------------------------------------
Epoch: 3
Epoch 3/50 | Loss = 0.0362
------------------------------------------------------------
Epoch: 4
Epoch 4/50 | Loss = 0.0221
------------------------------------------------------------
Epoch: 5
Epoch 5/50 | Loss = 0.0069
------------------------------------------------------------
Epoch: 6
Epoch 6/50 | Loss = 0.0324
------------------------------------------------------------
Epoch: 7
Epoch 7/50 | Loss = 0.0216
------------------------------------------------------------
Epoch: 8
Epoch 8/50 | Loss = 0.0234
------------------------------------------------------------
Epoch: 9
Epoch 9/50 | Loss = 0.0237
------------------------------------------------------------
Epoch: 10
Epoch 10/50 | Loss = 0.0222
------------------------------------------------------------
Epoch: 11
Epoch 11/50 | Loss = 0.0130
------------------------------------------------------------
Epoch: 12
Epoch 12/50 | Loss = 0.0513
------------------------------------------------------------
Epoch: 13
Epoch 13/50 | Loss = 0.0152
------------------------------------------------------------
Epoch: 14
Epoch 14/50 | Loss = 0.0163
------------------------------------------------------------
Epoch: 15
Epoch 15/50 | Loss = 0.0354
------------------------------------------------------------
Epoch: 16
Epoch 16/50 | Loss = 0.0123
------------------------------------------------------------
Epoch: 17
Epoch 17/50 | Loss = 0.0165
------------------------------------------------------------
Epoch: 18
Epoch 18/50 | Loss = 0.0298
------------------------------------------------------------
Epoch: 19
Epoch 19/50 | Loss = 0.0250
------------------------------------------------------------
Epoch: 20
Epoch 20/50 | Loss = 0.0275
------------------------------------------------------------
Epoch: 21
Epoch 21/50 | Loss = 0.0341
------------------------------------------------------------
Epoch: 22
Epoch 22/50 | Loss = 0.0110
------------------------------------------------------------
Epoch: 23
Epoch 23/50 | Loss = 0.0182
------------------------------------------------------------
Epoch: 24
Epoch 24/50 | Loss = 0.0235
------------------------------------------------------------
Epoch: 25
Epoch 25/50 | Loss = 0.0063
------------------------------------------------------------
Epoch: 26
Epoch 26/50 | Loss = 0.0261
------------------------------------------------------------
Epoch: 27
Epoch 27/50 | Loss = 0.0114
------------------------------------------------------------
Epoch: 28
Epoch 28/50 | Loss = 0.0080
------------------------------------------------------------
Epoch: 29
Epoch 29/50 | Loss = 0.0529
------------------------------------------------------------
Epoch: 30
Epoch 30/50 | Loss = 0.0189
------------------------------------------------------------
Epoch: 31
Epoch 31/50 | Loss = 0.0241
------------------------------------------------------------
Epoch: 32
Epoch 32/50 | Loss = 0.0293
------------------------------------------------------------
Epoch: 33
Epoch 33/50 | Loss = 0.0272
------------------------------------------------------------
Epoch: 34
Epoch 34/50 | Loss = 0.0170
------------------------------------------------------------
Epoch: 35
Epoch 35/50 | Loss = 0.0186
------------------------------------------------------------
Epoch: 36
Epoch 36/50 | Loss = 0.0154
------------------------------------------------------------
Epoch: 37
Epoch 37/50 | Loss = 0.0341
------------------------------------------------------------
Epoch: 38
Epoch 38/50 | Loss = 0.0111
------------------------------------------------------------
Epoch: 39
Epoch 39/50 | Loss = 0.0073
------------------------------------------------------------
Epoch: 40
Epoch 40/50 | Loss = 0.0138
------------------------------------------------------------
Epoch: 41
Epoch 41/50 | Loss = 0.0168
------------------------------------------------------------
Epoch: 42
Epoch 42/50 | Loss = 0.0384
------------------------------------------------------------
Epoch: 43
Epoch 43/50 | Loss = 0.0171
------------------------------------------------------------
Epoch: 44
Epoch 44/50 | Loss = 0.0328
------------------------------------------------------------
Epoch: 45
Epoch 45/50 | Loss = 0.0257
------------------------------------------------------------
Epoch: 46
Epoch 46/50 | Loss = 0.0295
------------------------------------------------------------
Epoch: 47
Epoch 47/50 | Loss = 0.0412
------------------------------------------------------------
Epoch: 48
Epoch 48/50 | Loss = 0.0311
------------------------------------------------------------
Epoch: 49
Epoch 49/50 | Loss = 0.0072
------------------------------------------------------------

Training complete â€” model saved.

Running inference...

[INFO] Writing video with 200 frames to ddpm_samples.mp4 ...
[INFO] Saved video to ddpm_samples.mp4

Inference complete. Video saved!
Traceback (most recent call last):
  File "/home/jbu7511/Diffusion-from-scratch/main.py", line 2, in <module>
    from src.forward_process import sample_time_steps, forward_diffusion, show_images
  File "/home/jbu7511/Diffusion-from-scratch/src/forward_process.py", line 1, in <module>
    import torch
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/__init__.py", line 2161, in <module>
    from torch import _VF as _VF, functional as functional  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/functional.py", line 8, in <module>
    import torch.nn.functional as F
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/nn/__init__.py", line 8, in <module>
    from torch.nn.modules import *  # usort: skip # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/nn/modules/__init__.py", line 1, in <module>
    from .module import Module  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 17, in <module>
    from torch.utils._python_dispatch import is_traceable_wrapper_subclass
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/__init__.py", line 8, in <module>
    from torch.utils import (
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/__init__.py", line 1, in <module>
    from torch.utils.data.dataloader import (
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 24, in <module>
    import torch.utils.data.graph_settings
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/graph_settings.py", line 8, in <module>
    from torch.utils.data.datapipes.iter.sharding import (
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/datapipes/__init__.py", line 1, in <module>
    from torch.utils.data.datapipes import dataframe as dataframe, iter as iter, map as map
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/datapipes/dataframe/__init__.py", line 1, in <module>
    from torch.utils.data.datapipes.dataframe.dataframes import (
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/datapipes/dataframe/dataframes.py", line 4, in <module>
    from torch.utils.data.datapipes._decorator import functional_datapipe
  File "/home/jbu7511/.local/lib/python3.12/site-packages/torch/utils/data/datapipes/_decorator.py", line 6, in <module>
    from torch.utils.data.datapipes._typing import _DataPipeMeta
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1091, in get_code
  File "<frozen importlib._bootstrap_external>", line 1191, in get_data
KeyboardInterrupt
